.Dd April 10, 2008
.Os Python 2.x
.Dt CBANK 1 USD
.Sh NAME
.Nm cbank
.Nd generate clusterbank reports
.Sh SYNOPSIS
.Nm
.Op Fl ehv
.Op Fl r , -resources Ar RESOURCES
.Op Fl p , -projects Ar PROJECTS
.Op Fl u , -users Ar USERS
.Op Fl a , -after Ar DATE
.Op Fl b , -before Ar DATE
.Op Ar report
.Sh DESCRIPTION
.Nm
generates reports based on data stored in the clusterbank database.
The
.Ar report
argument specifies which report to generate. Reports available are "usage" (default), "projects" , "allocations", and "charges".
.Pp
The Options are as follows: 
.Bl -tag
.It Fl h , -help
Display a help summary and exit.
.It Fl v , -version
Display version information and exit.
.It Fl r , -resources
Report data for projects allocated time on a resource listed in
.Ar RESOURCES .
Separate resource names with a comma (,).
.It Fl p , -projects
Report data for projects whose names are listed in
.Ar PROJECTS .
Separate project names with a comma (,).
.It Fl u , -users
Report data for users whose names are listed in
.Ar USERS .
Separate user names with a comma (,).
In the project and allocation reports a user must be a member of the project.
In the charge report a user must have made the charge.
.It Fl a , -after
Report data after
.Ar DATE .
Valid formats are YYYY-MM-DD, YY-MM-DD, MM/DD/YYYY, MM/DD/YY, YYYYMMDD.
In the project and allocation reports an allocation must be available after
.Ar DATE .
In the charge report the charge must have been made after
.Ar DATE .
.It Fl b , -before
Report data before
.Ar DATE .
Valid formats are YYYY-MM-DD, YY-MM-DD, MM/DD/YYYY, MM/DD/YY, YYYYMMDD.
In the project and allocation reports an allocation must be available before
.Ar DATE .
In the charge report the charge must have been before after
.Ar DATE .
.It Fl e , -extra-data
Include extra data stored with the record in the report (if available).
.El
.Sh ENVIRONMENT
Reports are restricted based on the uid of the user running
.Nm .
Project members can generate the usage, project, and allocation reports for their projects,
and can generate charge reports for the charges that they made. Project owners
can generate charge reports for all charges in the project. Admins can generate
all reports.
.Sh FILES
.Pa /etc/clusterbank.conf
.Nm
looks for a [cbank] section in the master clusterbank configuration file.
.Pp
The directives are as follows:
.Bl -tag
.It admins
The names of users who are allowed access to all data.
Separate user names with a comma (,).
.It unit_factor
A conversion factor to use when displaying amounts.
Factors can be entered in decimal notation (0.5) or fractional notation (1/2).
.It unit_label
A description of the units displayed to be included at the bottom of the report.
.It resource
A default resource name to report data for.
.El
.Sh EXAMPLES
Generate the default usage report:
.Pp
.D1 cbank
or
.D1 cbank usage
.Pp
Generate a usage report for all usage during April 2008:
.Pp
.D1 cbank usage -a 2008-04-01 -b 2008-05-01
.Pp
Generate a charge report for project "foo" on all resources, nullifying any default resource specified in
.Pa /etc/clusterbank.conf :
.Pp
.D1 cbank charges -p foo --resources=
.Pp
Generate an allocation report for projects having members "bar" and "baz" (and the current user):
.Pp
.D1 cbank allocations -u bar,baz
.Pp
Generate a report of all charges made for the "grail" project by "monty" on or after 16 April 2008 for any resource.
.D1 cbank charges -p grail --resource= --extra-data -u monty -a 2008-04-16
.Sh AUTHORS
.An Jonathon Anderson
.Ad janderso@alcf.anl.gov
.Sh BUGS
Submit bug reports to the clusterbank trac at
.Ad http://trac.mcs.anl.gov/projects/clusterbank
